var simplePanels=function(e,t,i){var n=this;this.headerContainer="undefined"!=typeof i?i:"header",this.parentContainer="undefined"!=typeof t?t:"section",this.theItem="undefined"!=typeof e?e:"article",$("body").append('<div class="panelsNavigation"><a href="" class="next"></a> <a href="" class="prev"></a><ul class="sublime-menu hide"> </ul></div>'),document.styleSheets[0].insertRule(".panelsNavigation *, ."+t.replace(".","")+" * {box-sizing: border-box; }",0);var a;window.addEventListener("scroll",function(){n.positionHeaders(),clearTimeout(a),a=setTimeout(function(){n.positionSlides()},300)}),document.onkeydown=function(e){e=e||window.event,34==e.keyCode||39==e.keyCode||40==e.keyCode?(e.preventDefault?e.preventDefault():e.returnValue=!1,n.goNextSlide()):(33==e.keyCode||37==e.keyCode||38==e.keyCode)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,n.goPrevSlide())},document.querySelector("a.next").addEventListener("click",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,n.goNextSlide()},!1),document.querySelector("a.prev").addEventListener("click",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,n.goPrevSlide()},!1),$(document).on("click",".sublime-menu li.section_marker",function(e){if(e.preventDefault?e.preventDefault():e.returnValue=!1,!$(this).hasClass("active")){$(".sublime-menu li.section_marker.active").removeClass("active");var t=$(this).attr("data-section-menu-link"),i=$('header[data-section-menu-link="'+t+'"]').parent(".section");$.scrollTo(i.offset().top,1e3)}}),$(document).on("click",".sublime-menu li.slide_marker",function(e){if(e.preventDefault?e.preventDefault():e.returnValue=!1,!$(this).hasClass("active")){var t=$(this).attr("data-slide-menu-link"),i=$('.slide[data-slide-menu-link="'+t+'"]'),n=i.offset().top+50;$.scrollTo(n,1e3)}}),$(window).resize($.debounce(400,function(){}));var o;window.addEventListener("resize",function(){clearTimeout(o),o=setTimeout(function(){n.getHeights(),n.positionSlides()},400)}),n.getViewport(),n.getHeights()};simplePanels.prototype.getViewport=function(){var e,t;"undefined"!=typeof window.innerWidth?(e=window.innerWidth,t=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):(e=document.getElementsByTagName("body")[0].clientWidth,t=document.getElementsByTagName("body")[0].clientHeight),this.viewport=[e,t]},simplePanels.prototype.positionSlides=function(){var e=this;$(e.parentContainer).each(function(){var t=$(this),i=t.offset(),n=$(window).scrollTop()+e.viewport[1]/2;n>i.top&&n<i.top+t.height()&&$(e.theItem,this).each(function(){$(this).removeClass("active_slide");var i=$(this),n=i.offset(),a=$(window).scrollTop()+e.viewport[1]/2;if(a>n.top&&a<n.top+i.height()){var o=$(".has_zoom",this);$(e.theItem).removeClass("active_slide"),$(this).addClass("active_slide"),$.scrollTo(i.offset().top+5,200),$(".normal").not(o).removeClass("normal").addClass("zoom"),o.removeClass("zoom").addClass("normal");var s=$(e.headerContainer,t).attr("data-section-menu-link"),l=$(this).attr("data-slide-menu-link");$(".sublime-menu li.active").removeClass("active"),$('.sublime-menu li[data-section-menu-link="'+s+'"]').addClass("active"),$('.sublime-menu li[data-slide-menu-link="'+l+'"]').addClass("active")}else console.log(a+">"+n.top+"&&"+a+"<"+n.top+i.height())})})},simplePanels.prototype.positionHeaders=function(){var e=this,t=!1;$(e.parentContainer).each(function(){var i=$(this),n=i.offset(),a=$(window).scrollTop();a>n.top&&a<n.top+i.height()?(floatingHeader=$(e.headerContainer,this),floatingHeader.css("position","fixed"),t=!0):$(e.headerContainer,this).css("position","relative")}),t?($(".mobile-menu").removeClass("hide"),$(".sublime-menu").removeClass("hide")):($(".mobile-menu").addClass("hide"),$(".sublime-menu").addClass("hide"))},simplePanels.prototype.getHeights=function(){var e=this;$(".sublime-menu").html(""),$(e.parentContainer).each(function(t){$(this).css("height",$(""+e.theItem,this).length*e.viewport[1]),$(e.theItem,this).css("height",e.viewport[1]),$(this).addClass("section-"+t);var i=$(e.headerContainer,this),n=i.css("background-color");i.attr("data-section-menu-link","header-"+t);var a=e.contrastingColor(n.replace("rgb(","").replace(")","").split(", ")),o=i.attr("data-title")?i.attr("data-title"):i.text();$(".sublime-menu").append('<li class="section_marker" data-section-menu-link="header-'+t+'" style="background-color:'+n+";color:#"+a+'">'+o+"</li>"),$(e.theItem,this).each(function(e){var i=$(this).attr("data-title")?$(this).attr("data-title"):$(this).find("h1").first().text();$(this).attr("data-slide-menu-link","slide-"+t+"-"+e),$(".sublime-menu").append('<li class="slide_marker" data-slide-menu-link="slide-'+t+"-"+e+'" style="background-color:'+n+';"><span>'+i+"</span></li>"),$("div",this).first().addClass("has_zoom normal")})})},simplePanels.prototype.contrastingColor=function(e){var t=this;return t.luma(e)>=165?"000":"fff"},simplePanels.prototype.luma=function(e){var t="string"==typeof e?hexToRGBArray(e):e;return.2126*t[0]+.7152*t[1]+.0722*t[2]},simplePanels.prototype.goNextSlide=function(){var e=this;$(".active_slide").next(e.theItem).length?$.scrollTo($(".active_slide").next(e.theItem).offset().top+5,400):$(".active_slide").parent().next(e.parentContainer).length&&$.scrollTo($(".active_slide").parent().next(e.parentContainer).find(e.theItem).first().offset().top+5,400)},simplePanels.prototype.goPrevSlide=function(){var e=this;$(".active_slide").prev(e.theItem).length?$.scrollTo($(".active_slide").prev(e.theItem).offset().top+5,400):$(".active_slide").parent().prev(e.parentContainer).length&&$.scrollTo($(".active_slide").parent().prev(e.parentContainer).find(e.theItem).last().offset().top+5,400)};